<!DOCTYPE html>
{% load i18n %}
{% load static %}
<html lang="{{ request.LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="icon" type="image/x-icon" href="{% static 'icons/1929_dev_fevicon2.jpg' %}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
    <script src="https://kit.fontawesome.com/6c3486d068.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
     <!-- Include Flatpickr CSS -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

     <!-- Include Flatpickr JS -->
     <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
         <link rel="stylesheet" href="{% static 'css/fontstyle.css' %}">


    <style>
        /* body,h1,h2,h3,h4,h5 {font-family: General Sans} */
        body {
            font-size:16px;
            background-color: rgb(233, 228, 228);
            font-family: 'IBMPlexSansArabic', 'SF Pro Display', sans-serif;

        }
        button{
            cursor: pointer;
        }
        .w3-sidebar{
            background-color: #85080C;
            color: white;
        }
        /* .bg-table-head {
            --bs-table-color: #fff;
            --bs-border-radius: 30px;
        } */

        table {
            border-collapse: separate;
            border-spacing: 0;
            overflow: hidden;
        }

        th {
            background-color: #FFD6D6;
            text-align: left;
        }

        th, td {
            padding: 10px;
            border: none;
        }


        thead:first-child th:first-child {
            border-top-left-radius: 15px;
        }

        tr:first-child th:last-child {
            border-top-right-radius: 15px;
        }

        tr:last-child td:first-child {
            border-bottom-left-radius: 15px;
        }

        tr:last-child td:last-child {
            border-bottom-right-radius: 15px;
        }


        /* Borders */
        .user-brd {
            border: 1px solid #BCBCBC;
        }
        .table-body-brd {
            border-left: 1px solid #BCBCBC;
            border-right: 1px solid #BCBCBC;
            border-bottom: 1px solid #BCBCBC;
        }

        /* .table-responsive {
                width: 100%;  Adjust as needed 
            }
            
            .table {
                width: 100%;  Adjust as needed 
            } */

        /* ############################### */


        .col-md-4 {
        display: inline-block;
        margin-right: 28px;
        }

        .btn{
            border-radius: 10px;
            padding: 10px;
            border: none;
            background-color: white;
        }

        .active{
            background-color: #85080C;
            color: white;
        }
        /* td{
            margin-left: 10px;
        } */
        
        .table-body-color{
            background-color: #FFF6F6;

        }
        .container-box{
            /* margin-top:20px; */
            padding: 20px;
        }
        .row-main{
            border-radius: 10px;
            padding: 20px;
            background-color: white;
        }
        .form-select{
            padding: 10px;
            border-radius: 10px;
            border-color: #FFD6D6;
            background-color: white;
        }
        /* .btn-blue{
            padding: 10px;
            padding-left: 10px;
            padding-right: 10px;
            border-radius: 32px;
            border-color: #85080C;
            background-color: white;
            color: #85080C;
            width: 200px;
        } */
        .btn-blue{
            padding: 10px;
            padding-left: 10px;
            padding-right: 10px;
            border-radius: 32px;
            border-color: #85080C;
            background-color: white;
            color: #85080C;
            width: 200px;
            cursor: pointer;
        }
        .border-right{
            border-right: 1px solid #BCBCBC;
            
        }
        .color-grey{
            color: #717171;
        }
        /* .top-container{
            background-color: white;
            padding: 10px;
            width: 84%;
            margin-left: auto;
            height: 100px;
            display: flex;
            
            
        } */
        .btn-search{
            padding: 10px;
            border-radius: 32px;
            width: 200px;
            border: none;
            margin-left: 30px;
            text-align: left;
            background-color: #D2D2D2
        }
        .brown{
            background-color: #85080C;
        }
        .box_container_input{
            background-color: #EDF0F9; 
            width: 250px; 
            border: none;  
            margin-right: 40px;
        }
        /* new changes */
        ul{
            list-style-type: none;
        }
        .upload_button{
            width: 450px;
        }
        .row{
            text-align: center;
        }
        .no_data_found {
            position: absolute; /* or absolute, depending on your layout */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 100px;
            text-align: center;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
        }
        #loader {
            color: #85080C;
            font-size: 10px;
            width: 1em;
            height: 1em;
            border-radius: 50%;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            text-indent: -9999em;
            animation: mulShdSpin 1.3s infinite linear;
            z-index: 9999; /* Ensure loader is above other content */
        }


            @keyframes mulShdSpin {
            0%,
            100% {
                box-shadow: 0 -3em 0 0.2em, 
                2em -2em 0 0em, 3em 0 0 -1em, 
                2em 2em 0 -1em, 0 3em 0 -1em, 
                -2em 2em 0 -1em, -3em 0 0 -1em, 
                -2em -2em 0 0;
            }
            12.5% {
                box-shadow: 0 -3em 0 0, 2em -2em 0 0.2em, 
                3em 0 0 0, 2em 2em 0 -1em, 0 3em 0 -1em, 
                -2em 2em 0 -1em, -3em 0 0 -1em, 
                -2em -2em 0 -1em;
            }
            25% {
                box-shadow: 0 -3em 0 -0.5em, 
                2em -2em 0 0, 3em 0 0 0.2em, 
                2em 2em 0 0, 0 3em 0 -1em, 
                -2em 2em 0 -1em, -3em 0 0 -1em, 
                -2em -2em 0 -1em;
            }
            37.5% {
                box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em,
                3em 0em 0 0, 2em 2em 0 0.2em, 0 3em 0 0em, 
                -2em 2em 0 -1em, -3em 0em 0 -1em, -2em -2em 0 -1em;
            }
            50% {
                box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em,
                3em 0 0 -1em, 2em 2em 0 0em, 0 3em 0 0.2em, 
                -2em 2em 0 0, -3em 0em 0 -1em, -2em -2em 0 -1em;
            }
            62.5% {
                box-shadow: 0 -3em 0 -1em, 2em -2em 0 -1em,
                3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 0, 
                -2em 2em 0 0.2em, -3em 0 0 0, -2em -2em 0 -1em;
            }
            75% {
                box-shadow: 0em -3em 0 -1em, 2em -2em 0 -1em, 
                3em 0em 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, 
                -2em 2em 0 0, -3em 0em 0 0.2em, -2em -2em 0 0;
            }
            87.5% {
                box-shadow: 0em -3em 0 0, 2em -2em 0 -1em, 
                3em 0 0 -1em, 2em 2em 0 -1em, 0 3em 0 -1em, 
                -2em 2em 0 0, -3em 0em 0 0, -2em -2em 0 0.2em;
            }
            }
        
        /*  */
        @media (max-width: 1440px) {
            .container-box{
                width: 1300px;
            }
            .row-main{
                width: 1300px;
            }
            .table-container {
                width: 1260px;
                overflow-x: auto;
            }

            .responsive-table {
                width: 1260px;
            }
        }
        
        @media (max-width: 1024px) {
            .container-box{
                width: 900px;
            }
           .row-main{
               width: 900px;
           }
           .table-container {
               width: 860px;
               overflow-x: auto;
           }

           .responsive-table {
               width: 860px;
           }
           .col-md-4{
                padding-bottom: 5px;
            }
            
       }
        
       @media (max-width: 768px) {
            .container-box{
                width: 730px;
            }
            
            .row-main{
                width: 730px;
                
            }
            .table-container {
                width: 690px;
                overflow-x: auto;
            }
           
            .responsive-table {
                width: 690px;
            }
            .box_container{
                display: flex;
                margin-bottom: 10px;
            }
            
        }
        @media (max-width: 425px) {
            .container-box{
                width: 380px;
            }
            .btn-search{
                width: 150px;
            }
            .row-main{
                width: 380px;
            }
            .table-container {
                width: 350px;
                overflow-x: auto;
            }

            .responsive-table {
                width: 350px;
            }
            .box_container_input{
                width: 150px;
            }
        }
        @media (max-width: 375px) {
            .container-box{
                width: 345px;
            }
            .btn-search{
                width: 120px;
                
            }
            .input-size{
                width: 40px;
            }
            .row-main{
                width: 345px;
            }
            .table-container {
                width: 310px;
                overflow-x: auto;
            }

            .responsive-table {
                width: 310px;
            }
            
            
        }
        @media (max-width: 320px) {
            .container-box{
                width: 270px;
            }
            .btn-search{
                width: 118px;
                margin-left: 4px;
                
            }
            .profile-btn{
                padding: 10px;
              
            }
            .search-btn{
                margin-right: auto;
            }
            .input-size{
                width: 20px;
            }
            .empty-container{
                width: 1px;
            }
            .row-main{
                width: 270px;
            }
            .table-container {
                width: 240px;
                overflow-x: auto;
            }

            .responsive-table {
                width: 240px;
            }
            
        }
        .blurred {
            filter: blur(5px);
            pointer-events: none;
        }
       
    </style>
</head>
<body>

    <div id="loader" style="display: none;"></div>

    <div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>
        <div class="w3-main" style="margin-left:40px; margin-top:auto">

            <div class="container container-box">
              
                <div class=" justify-content-center">

                    <div class="" >
                        <div class="col-md-4"> 
                            <button class="w3-badge w3-xlarge  w3-white" style="border: none;"><a href="{%url 'loginn'%}" style="text-decoration: none;"><i class="fa-solid fa-arrow-left fa-lg " ></i></a></button>
                        </div>    
                        
                    </div>
                    
                    <br>

                    <div class="row-main" id="hotelTable">
                        <div class="row ">
                            <div class="col-md-4">
                                
                                <form >
    
                                    <input type="text" ondblclick="resetDate('datePicker')" id="datePicker" class="form-select select_fromdate fs12 text-black"  style="width: 180px;" name="date" placeholder="From: Sep 8, 2023">
                                    
                                </form>
                                
                            </div>
                            <div class="col-md-4">
                                <form >
    
                                    <input type="text" ondblclick="resetDate('datePicker1')" id="datePicker1" class="form-select select_todate fs12 text-black"  style="width: 180px;" name="date" placeholder="To: Sep 8, 2023">
                                    
                                </form>
                            </div>
                            <div class="col-md-4">
                                    <select aria-label="Default select example" class="form-select select_approved fs12 text-black">
                                        <option value="">All</option>
                                        <option value="True">Approved</option>
                                        <option value="False">Not Approved</option>
                                        
                                        
                                    </select>
                            </div>
                            
                            <div class="col-md-4">
                                <select aria-label="Default select example" class="form-select select_hotel  fs12 text-black">
                                    {%for category in categories%}
                                    <option value="{{category}}">{{category}} </option>
                                    {%endfor%}
                                    
                                </select>
                            </div>

                            <div class="col-md-4">
                                <button class=" btn-blue search_button" type="button">
                                    <i class="fa-solid fa-magnifying-glass"></i> {% trans "Search" %} 
                                </button>
                            </div>

                            
                        </div>
                        <div >
                                
                            <br>
                            <div class="col-md-12 ">
                                <div class="table-container">
                                    <div class="hotel_table">
                                        <table class="w3-table responsive-table ">
                                            <thead class=" bg-table-head">
                                                <tr>
                                                    <th class="border-right">{% trans "Hotel Name" %}</th>
                                                    <th class="border-right">{% trans "Hotel Owner Name" %} </th>
                                                    <th class="border-right">{% trans "Hotel Owner Email" %} </th>
                                                    <th class="border-right">{% trans "Office Number" %} </th>
                                                    <th class="border-right">{% trans "GSM Number" %} </th>
                                                    <th class="border-right">{% trans "Hotel Address" %} </th>
                                                    <th class="border-right">{% trans "Country" %} </th>
                                                    <th class="border-right">{% trans "State/Province" %} </th>
                                                    <th class="border-right">{% trans "City" %} </th>
                                                    <th class="border-right">{% trans "Postal/ZIP Code" %} </th>
                                                    <th class="border-right">{% trans "Number of Rooms" %} </th>
                                                    <th class="border-right">{% trans "Room Type" %} </th>
                                                    <th class="border-right">{% trans "Hotel Rating" %} </th>
                                                    <th class="border-right">{% trans "CR Number" %} </th>
                                                    <th class="border-right">{% trans "Date of Expiry" %} </th>
                                                    <th class="border-right">{% trans "VAT Number" %} </th>
                                                    <th class=""></th>
                                                </tr>
                                            </thead>
                                            
                                            <tbody class="fs12 table-body-color">
                                                {%for data in hotel_data%}
                                                <tr class="">
                                                    <td class="border-right">{{data.name}}</td>
                                                    <td class="border-right">{{data.vendor.user.first_name}}</td>
                                                    <td class="border-right">{{data.vendor.user.email}}</td>
                                                    <td class="border-right">{{data.office_number}}</td>
                                                    <td class="border-right">{{data.vendor.gsm_number}}</td>
                                                    <td class="border-right">{{data.address}}</td>
                                                    <td class="border-right">{{data.country}}</td>
                                                    <td class="border-right">{{data.state}}</td>
                                                    <td class="border-right">{{data.city}}</td>
                                                    <td class="border-right">{{data.city.postal_code}}</td>
                                                    <td class="border-right">{{data.number_of_rooms}}</td>
                                                    <td class="border-right " >{{data.room_types.all|join:", "}}</td>
                                                    <td class="border-right">{{data.hotel_rating}}</td>
                                                    <td class="border-right">{{data.cr_number}}</td>
                                                    <td class="border-right">{{data.date_of_expiry}}</td>
                                                    <td class="border-right">{{data.vat_number}}</td>
                                                    <td class="color-grey"><a href="{%url 'hotel_approval' data.id%}" style="text-decoration: none;">{% trans "View" %}</a></td>
                                                </tr>
                                                {%endfor%}
                                                
                                            </tbody>
                            
                                        </table>
                                        
                                    </div>
                                    <div class="chalet_table" style="display: none;">
                                        <table class="w3-table responsive-table " >
                                            <thead class=" bg-table-head">
                                                <tr>
                                                    <th class="border-right">{% trans "Chalet Name" %}</th>
                                                    <th class="border-right">{% trans "Chalet Owner Name" %}</th>
                                                    <th class="border-right">{% trans "Chalet Owner Email" %}</th>
                                                    <th class="border-right">{% trans "Office Number" %}</th>
                                                    <th class="border-right">{% trans "GSM Number" %}</th>
                                                    <th class="border-right">{% trans "Chalet Address" %}</th>
                                                    <th class="border-right">{% trans "Country" %}</th>
                                                    <th class="border-right">{% trans "State/ Province" %}</th>
                                                    <th class="border-right">{% trans "City" %}</th>
                                                    <th class="border-right">{% trans "Postal/ZIP Code" %}</th>
                                                    <th class="border-right">{% trans "Propert Type" %}</th>
                                                    <th class="border-right">{% trans "CR Number" %}</th>
                                                    <th class="border-right">{% trans "Date of Expiry" %}</th>
                                                    <th class="border-right">{% trans "VAT Number" %}</th>
                                                    <th class=""></th>
                                                </tr>
                                            </thead>
                                            
                                            <tbody class="fs12 table-body-color">
                                                {%for data in hotel_data%}
                                                <tr class="">
                                                    <td class="border-right">{{data.name}}</td>
                                                    <td class="border-right">{{data.vendor.user.first_name}}</td>
                                                    <td class="border-right">{{data.vendor.user.email}}</td>
                                                    <td class="border-right">{{data.office_number}}</td>
                                                    <td class="border-right">{{data.vendor.gsm_number}}</td>
                                                    <td class="border-right">{{data.address}}</td>
                                                    <td class="border-right">{{data.country}}</td>
                                                    <td class="border-right">{{data.state}}</td>
                                                    <td class="border-right">{{data.city}}</td>
                                                    <td class="border-right">{{data.city.postal_code}}</td>
                                                    <td class="border-right " >{{data.property_types.all|join:", "}}</td>
                                                    <td class="border-right">{{data.cr_number}}</td>
                                                    <td class="border-right">{{data.date_of_expiry}}</td>
                                                    <td class="border-right">{{data.vat_number}}</td>

                                                    <td class="color-grey"><a href="{%url 'chalet_approval' data.id%}" style="text-decoration: none;">{% trans "View" %}</a></td>
                                                </tr>
                                                {%endfor%}
    
                                                
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        
                        </div>

                    </div>
                    <div class="no_data_found" style="display: none; "></div>
                </div>
            </div>
        

        </div>

        <script type="text/javascript">
            window.CSRF_TOKEN = '{{ csrf_token }}';
        </script>

    <script>
        // Script to open and close sidebar
        function w3_open() {
        document.getElementById("mySidebar").style.display = "block";
        document.getElementById("myOverlay").style.display = "block";
        }
        
        function w3_close() {
        document.getElementById("mySidebar").style.display = "none";
        document.getElementById("myOverlay").style.display = "none";
        }
        document.addEventListener('DOMContentLoaded', function() {
            flatpickr("#datePicker", {
                enableTime: false,  
                dateFormat: "Y-m-d"

            });
            flatpickr("#datePicker1", {
                enableTime: false,  
                dateFormat: "Y-m-d"

            });
        });
        
        function resetDate(dateId) {
            document.getElementById(dateId).value = '';
        }

        $(document).ready(function(){
            $('.search_button').click(function(event){

                event.preventDefault();

                $('#loader').show();
                $('#hotelTable').addClass('blurred');

                var loaderTimeout = setTimeout(function() {
                    $('#loader').hide();
                    $('#hotelTable').removeClass('blurred');
                }, 1000);

                var from_date = $('.select_fromdate').val();
                var to_date = $('.select_todate').val();   
                var category_type = $('.select_hotel').val();
                var approved = $('.select_approved').val();
                console.log(from_date,to_date,category_type,approved);
                if(category_type == "CHALET"){

                    $('.hotel_table ').hide();
                    $('.chalet_table').show();
                }
                else if(category_type == "HOTEL"){

                    $('.chalet_table').hide();
                    $('.hotel_table ').show();
                    
                }
                setTimeout(function() {
                    $.ajax({
                        url:'{%url "hotel_table_list" %}',
                        type:'POST',
                        headers: {
                            'X-CSRFToken': window.CSRF_TOKEN
                        },
                        data:{
                            "from_date":from_date,
                            "to_date":to_date,
                            "category_type":category_type,
                            "approved":approved
                        },
                        success:function(data){

                           clearTimeout(loaderTimeout);

                           $('#loader').hide();
                           $('#hotelTable').removeClass('blurred');

                            // console.log(data);
                            // $(' table tbody').html($(data).find(' table tbody').html())
                            if (category_type == "CHALET") {
                                // $('.chalet_table table tbody').html($(data).find('.chalet_table table tbody').html());
                                var chaletData = $(data).find('.chalet_table table tbody').html();
                                if (chaletData.trim() === '') {
                                    // $('.no_data_found').html('No chalet found').show();
                                    // $('.chalet_table table tbody').empty();
                                    $('.chalet_table table tbody').html('<tr><td colspan="17" style="text-align: center;">No data found</td></tr>');
                                } else {
                                    $('.no_data_found').hide();
                                    $('.chalet_table table tbody').html(chaletData);
                                }
                            } else if (category_type == "HOTEL") {
                                // $('.hotel_table table tbody').html($(data).find('.hotel_table table tbody').html());
                                var hotelData = $(data).find('.hotel_table table tbody').html();
                                if (hotelData.trim() === '') {
                                    // $('.no_data_found').html('No hotel found').show();
                                    // $('.hotel_table table tbody').empty();
                                    $('.hotel_table table tbody').html('<tr><td colspan="17" style="text-align: center;">No data found</td></tr>');
                                } else {
                                    $('.no_data_found').hide();
                                    $('.hotel_table table tbody').html(hotelData);
                                }
                            }
                        },
                        error:function(xhr,status,error){
                            clearTimeout(loaderTimeout);
                            $('#loader').hide();
                            console.error('error :',error);
                        }
                    });
                }, 500);  
                     
                // if(category_type == "HOTEL"){
                //     $('.chalet_table').css('display', 'none');
                //     $('.hotel_table').css('display', 'table');
                //     $.ajax({
                //         url:'{%url "hotel_table_list" %}',
                //         type:'POST',
                //         headers: {
                //             'X-CSRFToken': window.CSRF_TOKEN
                //         },
                //         data:{
                //             "from_date":from_date,
                //             "to_date":to_date,
                //             "category_type":category_type,
                //             "approved":approved
                //         },
                //         success:function(data){
                //             $('table tbody').html($(data).find('table tbody').html())
                //         },
                //         error:function(xhr,status,error){
                //             console.error('error :',error);
                //         }
                //     });
                // }
                
            })
        });

        
    </script>
    
</body>
</html>